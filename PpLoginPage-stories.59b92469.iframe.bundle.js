"use strict";(self.webpackChunk_haaretz_a_tm_sg=self.webpackChunk_haaretz_a_tm_sg||[]).push([[5839],{"../../pp-pages/s-pp-login-page/src/PpLoginPage.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Overview:()=>Overview,__namedExportsOrder:()=>__namedExportsOrder,default:()=>PpLoginPage_stories});var defineProperty=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.1/node_modules/@babel/runtime/helpers/esm/defineProperty.js"),react=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),src=__webpack_require__("../../utils/s-pp-storybook-providers/src/index.ts"),esm_extends=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.1/node_modules/@babel/runtime/helpers/esm/extends.js"),objectWithoutProperties=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.1/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),PurchasePage=__webpack_require__("../../graphql/s-pp-queries/src/__generated__/PurchasePage.ts"),style9=__webpack_require__("../../../node_modules/.pnpm/style9@0.17.0_rollup@2.79.1/node_modules/style9/index.mjs"),s_pp_image_src=__webpack_require__("../../pp-atoms/s-pp-image/src/index.ts"),dist=__webpack_require__("../../../node_modules/.pnpm/next-router-mock@0.9.2_next@13.2.3+react@18.2.0/node_modules/next-router-mock/dist/index.js"),s_pp_header_src=__webpack_require__("../../pp-molecules/s-pp-header/src/index.ts"),UserCredentialsType=__webpack_require__("../../graphql/s-fragments/src/__generated__/UserCredentialsType.ts"),useMutation=__webpack_require__("../../../node_modules/.pnpm/@tanstack+react-query@4.24.4_biqbaboplfbrettd7655fr4n2y/node_modules/@tanstack/react-query/build/lib/useMutation.mjs"),GraphqlFetcher=__webpack_require__("../../graphql/s-graphql-fetcher/src/GraphqlFetcher.tsx");const LoginMutationDocument=`\n    mutation LoginMutation($input: LoginInputType!) {\n  login(input: $input) {\n    ...UserCredentialsTypeFragment\n  }\n}\n    ${UserCredentialsType.F}`,useLoginMutation=options=>(0,useMutation.D)(["LoginMutation"],(variables=>(0,GraphqlFetcher.Z)(LoginMutationDocument,variables)()),options);useLoginMutation.getKey=()=>["LoginMutation"],useLoginMutation.fetcher=(variables,options)=>(0,GraphqlFetcher.Z)(LoginMutationDocument,variables,options);const handle_response=function handleResponse(data){var _data$user;const abuse=null===(_data$user=data.user)||void 0===_data$user?void 0:_data$user.abuse,success=data.success,messages=data.messages;if(!1===success&&"abuse-logout"===(null==messages?void 0:messages[0])&&abuse){var _data$user2;const token=null==data||null===(_data$user2=data.user)||void 0===_data$user2?void 0:_data$user2.abuse.redirect,redirect="string"==typeof token?/(\/abuse):(.*):(.*)/.exec(token):null,redirectInfo=redirect?{url:`https://login.themarker.com${redirect[1]}`,email:redirect[2],sso:redirect[3]}:null;if(redirectInfo){const loginData="undefined"==typeof document?Buffer.from(JSON.stringify(redirectInfo)).toString("base64"):btoa(JSON.stringify(redirectInfo)),url=`${redirectInfo.url}?loginData=${loginData}`;window.location.assign(url)}}};var use_user=__webpack_require__("../../hooks/s-use-user/src/use-user/index.ts");function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){(0,defineProperty.Z)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function useLogin(options){const{refetch}=(0,use_user.Z)();return useLoginMutation(_objectSpread(_objectSpread({},options),{},{onSuccess:async(data,variables,context)=>{handle_response(null==data?void 0:data.login),await refetch(),"function"==typeof(null==options?void 0:options.onSuccess)&&options.onSuccess(data,variables,context)}}))}try{useLogin.displayName="useLogin",useLogin.__docgenInfo={description:"",displayName:"useLogin",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../../hooks/s-use-user/src/use-login/useLogin.tsx#useLogin"]={docgenInfo:useLogin.__docgenInfo,name:"useLogin",path:"../../hooks/s-use-user/src/use-login/useLogin.tsx#useLogin"})}catch(__react_docgen_typescript_loader_error){}const use_login=useLogin,RegistrationMutationDocument=`\n    mutation RegistrationMutation($input: RegistrationInputType!) {\n  registration(input: $input) {\n    ...UserCredentialsTypeFragment\n  }\n}\n    ${UserCredentialsType.F}`,useRegistrationMutation=options=>(0,useMutation.D)(["RegistrationMutation"],(variables=>(0,GraphqlFetcher.Z)(RegistrationMutationDocument,variables)()),options);function useRegistration_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function useRegistration_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?useRegistration_ownKeys(Object(source),!0).forEach((function(key){(0,defineProperty.Z)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):useRegistration_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function useRegistration(options){const{refetch}=(0,use_user.Z)();return useRegistrationMutation(useRegistration_objectSpread(useRegistration_objectSpread({},options),{},{onSuccess:async(data,variables,context)=>{handle_response(null==data?void 0:data.registration),await refetch(),"function"==typeof(null==options?void 0:options.onSuccess)&&options.onSuccess(data,variables,context)}}))}useRegistrationMutation.getKey=()=>["RegistrationMutation"],useRegistrationMutation.fetcher=(variables,options)=>(0,GraphqlFetcher.Z)(RegistrationMutationDocument,variables,options);try{useRegistration.displayName="useRegistration",useRegistration.__docgenInfo={description:"",displayName:"useRegistration",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../../hooks/s-use-user/src/use-registration/useRegistration.tsx#useRegistration"]={docgenInfo:useRegistration.__docgenInfo,name:"useRegistration",path:"../../hooks/s-use-user/src/use-registration/useRegistration.tsx#useRegistration"})}catch(__react_docgen_typescript_loader_error){}const use_registration=useRegistration,UpdateUserMutationDocument=`\n    mutation UpdateUserMutation($input: UpdateUserInputType!) {\n  updateUser(input: $input) {\n    ...UserCredentialsTypeFragment\n  }\n}\n    ${UserCredentialsType.F}`,useUpdateUserMutation=options=>(0,useMutation.D)(["UpdateUserMutation"],(variables=>(0,GraphqlFetcher.Z)(UpdateUserMutationDocument,variables)()),options);useUpdateUserMutation.getKey=()=>["UpdateUserMutation"],useUpdateUserMutation.fetcher=(variables,options)=>(0,GraphqlFetcher.Z)(UpdateUserMutationDocument,variables,options);var useUser=__webpack_require__("../../hooks/s-use-user/src/use-user/useUser.tsx");function useUpdateUser_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function useUpdateUser_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?useUpdateUser_ownKeys(Object(source),!0).forEach((function(key){(0,defineProperty.Z)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):useUpdateUser_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}function useUpdateUser(options){const{refetch}=(0,useUser.Z)();return useUpdateUserMutation(useUpdateUser_objectSpread(useUpdateUser_objectSpread({},options),{},{onSuccess:async(data,variables,context)=>{handle_response(null==data?void 0:data.updateUser),await refetch(),"function"==typeof(null==options?void 0:options.onSuccess)&&options.onSuccess(data,variables,context)}}))}try{useUpdateUser.displayName="useUpdateUser",useUpdateUser.__docgenInfo={description:"",displayName:"useUpdateUser",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../../hooks/s-use-user/src/use-update-user/useUpdateUser.tsx#useUpdateUser"]={docgenInfo:useUpdateUser.__docgenInfo,name:"useUpdateUser",path:"../../hooks/s-use-user/src/use-update-user/useUpdateUser.tsx#useUpdateUser"})}catch(__react_docgen_typescript_loader_error){}const use_update_user=useUpdateUser;var useQuery=__webpack_require__("../../../node_modules/.pnpm/@tanstack+react-query@4.24.4_biqbaboplfbrettd7655fr4n2y/node_modules/@tanstack/react-query/build/lib/useQuery.mjs");__webpack_require__("../../../node_modules/.pnpm/@tanstack+react-query@4.24.4_biqbaboplfbrettd7655fr4n2y/node_modules/@tanstack/react-query/build/lib/useInfiniteQuery.mjs");const CheckEmailExistPersonalQueryDocument="\n    query CheckEmailExistPersonalQuery($email: String!, $site: Site!) {\n  user: userLogin(email: $email) {\n    ssoId: _id\n    mobilePhone\n    isPaying(site: $site)\n    termsCheck(site: $site)\n    userStatus {\n      ...UserStatusFragment\n    }\n  }\n}\n    \n    fragment UserStatusFragment on UserStatus {\n  __typename\n  isMailValidated\n  isMobileValidated\n  miniRegStatus\n  isPhoneEmailConn\n}\n    ",useCheckEmailExistPersonalQuery=(variables,options)=>(0,useQuery.a)(["CheckEmailExistPersonalQuery",variables],(0,GraphqlFetcher.Z)(CheckEmailExistPersonalQueryDocument,variables),options);useCheckEmailExistPersonalQuery.document=CheckEmailExistPersonalQueryDocument,useCheckEmailExistPersonalQuery.getKey=variables=>["CheckEmailExistPersonalQuery",variables];function useCheckEmailExist(variables,options){return useCheckEmailExistPersonalQuery(variables,options)}useCheckEmailExistPersonalQuery.fetcher=(variables,options)=>(0,GraphqlFetcher.Z)(CheckEmailExistPersonalQueryDocument,variables,options),useCheckEmailExist.getKey=useCheckEmailExistPersonalQuery.getKey,useCheckEmailExist.fetcher=useCheckEmailExistPersonalQuery.fetcher;const use_check_exist_user=useCheckEmailExist;const ValidateEmailQueryDocument="\n    query ValidateEmailQuery($email: String!, $site: Site!) {\n  validateEmail(email: $email, site: $site) {\n    status\n    result\n  }\n}\n    ",useValidateEmailQuery=(variables,options)=>(0,useQuery.a)(["ValidateEmailQuery",variables],(0,GraphqlFetcher.Z)(ValidateEmailQueryDocument,variables),options);useValidateEmailQuery.document=ValidateEmailQueryDocument,useValidateEmailQuery.getKey=variables=>["ValidateEmailQuery",variables];function useValidateEmail(variables,options){return useValidateEmailQuery(variables,options)}useValidateEmailQuery.fetcher=(variables,options)=>(0,GraphqlFetcher.Z)(ValidateEmailQueryDocument,variables,options),useValidateEmail.getKey=useValidateEmailQuery.getKey,useValidateEmail.fetcher=useValidateEmailQuery.fetcher;const use_validate_email=useValidateEmail;var s_generate_subscription_text_src=__webpack_require__("../../utils/s-generate-subscription-text/src/index.ts"),s_button_src=__webpack_require__("../../ds-atoms/s-button/src/index.ts"),QueryClientProvider=__webpack_require__("../../../node_modules/.pnpm/@tanstack+react-query@4.24.4_biqbaboplfbrettd7655fr4n2y/node_modules/@tanstack/react-query/build/lib/QueryClientProvider.mjs"),queryObserver=__webpack_require__("../../../node_modules/.pnpm/@tanstack+query-core@4.24.4/node_modules/@tanstack/query-core/build/lib/queryObserver.mjs"),usePPDataStore=__webpack_require__("../../pp-hooks/s-use-pp-data-store/src/usePPDataStore.tsx"),getFirstStep=__webpack_require__("../../pp-utils/s-pp-routing-utils/src/getFirstStep/index.ts"),s_use_pp_data_variables_src=__webpack_require__("../../pp-hooks/s-use-pp-data-variables/src/index.ts"),usePPStepsOffsetStore=__webpack_require__("../../pp-hooks/s-use-pp-offset-steps-store/src/usePPStepsOffsetStore.tsx"),EmailField=__webpack_require__("../../ds-molecules/s-form-fields/src/EmailField/index.ts");const s_pp_errors_src=__webpack_require__("../../pp-atoms/s-pp-errors/src/PpErrors.tsx").Z;var s_consts_src=__webpack_require__("../../shared/s-consts/src/index.ts"),getAbandonedCartLink=__webpack_require__("../../pp-utils/s-pp-build-promotions-link/src/getAbandonedCartLink/index.ts"),s_use_config_src=__webpack_require__("../../hooks/s-use-config/src/index.ts"),isFilledPpOffersStore=__webpack_require__("../../utils/s-type-predicates/src/isFilledPpOffersStore/index.ts"),cookieToMap=__webpack_require__("../../utils/s-cookie-utils/src/cookieToMap/index.ts"),decodeUnicodeBase64=__webpack_require__("../../utils/s-common-utils/src/decodeUnicodeBase64/index.ts"),emailValidator=__webpack_require__("../../utils/s-validators/src/emailValidator/index.ts"),isAbandonedCartRoute=__webpack_require__("../../pp-utils/s-pp-routing-utils/src/isAbandonedCartRoute/index.ts"),getCurrentStepName=__webpack_require__("../../pp-utils/s-pp-routing-utils/src/getCurrentStepName/index.ts"),generatePath=__webpack_require__("../../pp-utils/s-pp-routing-utils/src/generatePath/index.ts"),isCoupon=__webpack_require__("../../utils/s-type-predicates/src/isCoupon/index.ts"),isPersonalCoupon=__webpack_require__("../../utils/s-type-predicates/src/isPersonalCoupon/index.ts"),isFreeCoupon=__webpack_require__("../../utils/s-type-predicates/src/isFreeCoupon/index.ts"),usePersonalFreeCoupon=__webpack_require__("../../pp-hooks/s-pp-use-coupon/src/usePersonalFreeCoupon/index.ts"),useRegularFreeCoupon=__webpack_require__("../../pp-hooks/s-pp-use-coupon/src/useRegularFreeCoupon/index.ts");const s_pp_forgot_password_src=__webpack_require__("../../pp-organisms/s-pp-forgot-password/src/PpForgotPassword.tsx").Z;var s_use_bi_src=__webpack_require__("../../hooks/s-use-bi/src/index.ts"),getCurrentStep=__webpack_require__("../../pp-utils/s-pp-routing-utils/src/getCurrentStep/index.ts"),getUtmQueryParameters=__webpack_require__("../../pp-utils/s-pp-build-promotions-link/src/getUtmQueryParameters/index.ts");const components_LoginForm=__webpack_require__("../../pp-pages/s-pp-login-page/src/components/LoginForm/LoginForm.tsx").Z;const components_RegistrationForm=__webpack_require__("../../pp-pages/s-pp-login-page/src/components/RegistrationForm/RegistrationForm.tsx").Z,_excluded=["selectedOfferId"];var __jsx=react.createElement;function PpLoginPage_page_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function PpLoginPage_page_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?PpLoginPage_page_ownKeys(Object(source),!0).forEach((function(key){(0,defineProperty.Z)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):PpLoginPage_page_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}const c={base:{marginTop:"EKhXX",marginInlineEnd:"gzedBA",marginInlineStart:"bMPiZO",maxWidth:"clobCc",paddingInlineEnd:"fxCImo",paddingInlineStart:"fPuwlT",width:"cRUUAa","@media all and (min-width:48em) and (max-width:79.9375em)":{marginTop:"gwGMXY",maxWidth:"CxjPw"},"@media all and (min-width:80em)":{marginTop:"gZIZae",maxWidth:"kUsvdA"},fontFamily:"cGpNyn"},fullForm:{rowGap:"eSylHt","@media all and (min-width:80em)":{rowGap:"btkajQ"}},button:{justifySelf:"BQbTc",marginTop:"ha_DTbp","@media all and (min-width:80em)":{marginTop:"ivBgPP"}},form:{display:"kbCXHY",columnGap:"kEFtPS",marginTop:"ha_DTbp",marginBottom:"dkSlsL",gridTemplateColumns:"iKUrOT"},fullWidthColumn:{gridColumnStart:"DIEXk"},image:{alignSelf:"duSHeH",display:"kQBRAp",fontSize:"hlSaYl",marginBottom:"lkCRcp",marginInlineStart:"bMPiZO",marginInlineEnd:"gzedBA",transform:"llUSp","@media all and (min-width:64em) and (max-width:79.9375em)":{marginTop:"gigqhD",transform:"FeLtm",fontSize:"iONdEg",marginBottom:"hjvVhl"},"@media all and (min-width:80em)":{fontSize:"jMPHzp",marginInlineStart:"griTvt",marginTop:"btTWBP",transform:"fLvSkW"}}},anonymousId=("undefined"!=typeof document?(0,cookieToMap.Z)(document.cookie):{}).anonymousId;const stageInstructions={emailEntry:"אנא הזינו אימייל, שישמש לכניסה לאתר",login:"אנא הזינו את הסיסמה שאיתה נרשמתם בעבר לאתר",registration:"אנא השלימו את ההרשמה לאתר",updateUserDetails:"אנא השלימו את ההרשמה לאתר"};function LoginPage(data){var _data$PurchasePage,_emailData$data,_emailData$data4,_emailData$data4$user,_emailData$data5,_emailData$data5$user;const pageData=null==data||null===(_data$PurchasePage=data.PurchasePage)||void 0===_data$PurchasePage?void 0:_data$PurchasePage.pageData,[user,setUser]=react.useState(void 0),client=(0,QueryClientProvider.NL)(),[shouldRedirect,setShouldRedirect]=react.useState(!1),router=(0,dist.useRouter)(),store=(0,usePPDataStore.JV)(),variables=(0,s_use_pp_data_variables_src.Z)(),{pushStep}=(0,usePPStepsOffsetStore.Qf)(),[errors,setErrors]=react.useState(void 0),[shouldValidateEmail,setShouldValidateEmail]=react.useState(!1),[shouldCheckEmail,setShouldCheckEmail]=react.useState(!1),redeemPersonalFreeCoupon=(0,usePersonalFreeCoupon.Z)(),redeemRegularFreeCoupon=(0,useRegularFreeCoupon.Z)(),[showForgotPasswordModal,setShowForgotPasswordModal]=react.useState(!1),biAction=(0,s_use_bi_src.Z)();function getBiData(){const currentStep=(null==pageData?void 0:pageData.steps)&&(0,getCurrentStep.Z)("login",null==pageData?void 0:pageData.allSteps).currentStepIndex+1,stageNumber="number"==typeof currentStep?currentStep.toString():void 0;return{additional_info:PpLoginPage_page_objectSpread({refactor:"true"},stageNumber?{stage_number:stageNumber}:{})}}const{data:userData}=(0,use_user.Z)();let defaultEmail="";const restorecart=router.query.restorecart,isUpdateDetailsStep="updateDetails"===(0,getCurrentStepName.Z)(router.pathname);if(restorecart){const restoredEmail=(0,decodeUnicodeBase64.Z)(restorecart);(0,emailValidator.Z)(restoredEmail).valid&&(defaultEmail=restoredEmail)}else isUpdateDetailsStep&&null!=userData&&userData.userName&&(defaultEmail=userData.userName);const[email,setEmail]=react.useState(defaultEmail),couponId=(0,usePPDataStore.vA)(),msPurchaseUrl=(0,s_use_config_src.Z)().get("msPurchaseUrl"),{periodCalc,productNumber}=store;react.useEffect((()=>{if(!couponId){const routeChangeStartHandler=()=>{pushStep("login")};return router.events.on("routeChangeStart",routeChangeStartHandler),()=>{router.events.off("routeChangeStart",routeChangeStartHandler)}}return()=>{}}),[couponId,null==pageData?void 0:pageData.steps,pushStep,router.events]);const{selectedOfferId}=variables,variablesWithoutSelectedOfferId=(0,objectWithoutProperties.Z)(variables,_excluded),emailDataEnv=react.useMemo((()=>({email,site:s_consts_src.pq})),[email]),validateEmailData=use_validate_email(emailDataEnv,{enabled:shouldValidateEmail,onError}),emailData=use_check_exist_user(emailDataEnv,{enabled:shouldCheckEmail,onError});react.useEffect((()=>{shouldValidateEmail&&(async()=>{var _validationData;let validationData=client.getQueryData(use_validate_email.getKey(emailDataEnv));null!==(_validationData=validationData)&&void 0!==_validationData&&_validationData.validateEmail||(validationData=await client.fetchQuery({queryKey:use_validate_email.getKey(emailDataEnv),queryFn:use_validate_email.fetcher(emailDataEnv)})),setShouldValidateEmail(!1),"valid"!==validationData.validateEmail.result?setErrors(['עשינו בדיקה ומצאנו שכתובת הדוא"ל שהזנתם אינה קיימת.']):setUser(null)})()}),[client,emailDataEnv,shouldValidateEmail]),react.useEffect((()=>{shouldCheckEmail&&(async()=>{var _result;let result=client.getQueryData(use_check_exist_user.getKey(emailDataEnv));null!==(_result=result)&&void 0!==_result&&_result.user||(result=await client.fetchQuery({queryKey:use_check_exist_user.getKey(emailDataEnv),queryFn:use_check_exist_user.fetcher(emailDataEnv)})),shouldCheckEmail&&result.user?setUser(result.user):setShouldValidateEmail(!0),setShouldCheckEmail(!1)})()}),[client,emailDataEnv,shouldCheckEmail]);const stage=function getLoginStep(user){return void 0===user?"emailEntry":null===user?"registration":user.userStatus.miniRegStatus?"updateUserDetails":"login"}(restorecart&&(null===(_emailData$data=emailData.data)||void 0===_emailData$data?void 0:_emailData$data.user)||user),title=periodCalc&&productNumber?`בחרתם ב${(0,s_generate_subscription_text_src.Z)(periodCalc,productNumber).replace("תשלום ","")}`:"מינוי דיגיטלי",instructions=stageInstructions[stage],isAbandonedCart=(0,isAbandonedCartRoute.Z)(router.query),onSuccess=response=>{var _response$messages;if(response.success){if(couponId&&pushStep("login"),(0,isFilledPpOffersStore.Z)(store)){const link=(0,getAbandonedCartLink.Z)(PpLoginPage_page_objectSpread(PpLoginPage_page_objectSpread({},store),{},{msPurchaseUrl,couponId}));fetch(link,{method:"GET",credentials:"include"})}if(client.removeQueries(PurchasePage.RF.getKey(variables)),client.removeQueries(PurchasePage.RF.getKey(variablesWithoutSelectedOfferId)),client.prefetchQuery({queryKey:PurchasePage.RF.getKey(variables),queryFn:PurchasePage.RF.fetcher(variables)}),isAbandonedCart){const{pathName,asPath}=(0,generatePath.Z)({nextStepName:"payment",asPath:router.asPath,currentQueryParams:router.query});router.replace(pathName,asPath,{shallow:!0})}else setShouldRedirect(!0)}else null!==(_response$messages=response.messages)&&void 0!==_response$messages&&_response$messages.length?setErrors(response.messages):setErrors([s_consts_src.TQ])};function onError(error){setErrors([error.message])}const loginData=use_login({onSuccess:response=>{onSuccess(response.login)},onError}),registrationData=use_registration({onSuccess:response=>{onSuccess(response.registration)},onError}),updateUserData=use_update_user({onSuccess:response=>{onSuccess(response.updateUser)},onError}),enabledPpQuery=shouldRedirect&&!!variables.selectedOfferId,utmParams=react.useMemo((()=>(0,getUtmQueryParameters.Z)(router.query)),[router.query]);react.useEffect((()=>{const unsubscribe=new queryObserver.z(client,{queryKey:PurchasePage.RF.getKey(variables),queryFn:PurchasePage.RF.fetcher(variables)}).subscribe((({status,data:ppData})=>{if("success"===status&&enabledPpQuery){var _ppData$PurchasePage,_ppData$PurchasePage2,_ppData$PurchasePage3,_ppData$PurchasePage4,_ppData$PurchasePage5;const steps=(null===(_ppData$PurchasePage=ppData.PurchasePage)||void 0===_ppData$PurchasePage?void 0:_ppData$PurchasePage.pageData.steps)||[],nextStep=(0,getFirstStep.Z)(steps),coupons={couponId:null===(_ppData$PurchasePage2=ppData.PurchasePage)||void 0===_ppData$PurchasePage2||null===(_ppData$PurchasePage3=_ppData$PurchasePage2.pageData)||void 0===_ppData$PurchasePage3?void 0:_ppData$PurchasePage3.contentId,personalCouponId:null===(_ppData$PurchasePage4=ppData.PurchasePage)||void 0===_ppData$PurchasePage4||null===(_ppData$PurchasePage5=_ppData$PurchasePage4.pageData)||void 0===_ppData$PurchasePage5?void 0:_ppData$PurchasePage5.personalCouponId};if((0,isCoupon.Z)(coupons)&&(0,isFreeCoupon.Z)(store))(0,isPersonalCoupon.Z)(coupons)?redeemPersonalFreeCoupon(PpLoginPage_page_objectSpread(PpLoginPage_page_objectSpread(PpLoginPage_page_objectSpread({},store),utmParams),{},{personalCouponId:coupons.personalCouponId,msPurchaseUrl,nextStepName:nextStep.name})):redeemRegularFreeCoupon(PpLoginPage_page_objectSpread(PpLoginPage_page_objectSpread(PpLoginPage_page_objectSpread({},store),utmParams),{},{couponId:coupons.couponId,msPurchaseUrl,nextStepName:nextStep.name}));else{const{pathName,asPath}=(0,generatePath.Z)({nextStepName:nextStep.name,asPath:router.asPath,currentQueryParams:router.query});router.replace(pathName,asPath,{shallow:!0})}setShouldRedirect(!1),unsubscribe()}}));return()=>{unsubscribe()}}),[client,enabledPpQuery,msPurchaseUrl,redeemPersonalFreeCoupon,redeemRegularFreeCoupon,router,store,utmParams,variables]);const buttonStateProps=emailData.isFetching||emailData.isLoading&&emailData.isFetched||validateEmailData.isFetching||validateEmailData.isLoading&&validateEmailData.isFetched||loginData.isLoading||registrationData.isLoading||updateUserData.isLoading?{state:"busy",busyNotice:"ממתין לתשובה"}:{state:"auto"};function clearEmail(){defaultEmail||(setErrors(void 0),setEmail(""),setUser(void 0))}return __jsx(react.Fragment,null,__jsx("div",{className:(0,style9.Z)(c.base)},__jsx(s_pp_forgot_password_src,{email,isOpen:showForgotPasswordModal,onToggle:setShowForgotPasswordModal}),__jsx(s_pp_header_src.Z,{currentStep:"login",title,instructions}),__jsx("form",{"aria-describedby":"pp-page-instructions",className:(0,style9.Z)(c.form,"emailEntry"!==stage&&c.fullForm),onSubmit:event=>{event.preventDefault(),setErrors(void 0),"emailEntry"!==stage||defaultEmail||function onEmailSubmit(event){const emailInput=event.currentTarget.elements.namedItem("email");if(emailInput){const newEmail=emailInput.value.trim();setEmail(newEmail),setShouldCheckEmail(!0),biAction(PpLoginPage_page_objectSpread({action_id:115,feature_type:"Login",newsletter_email:emailInput.value,stage:"login"},getBiData()))}}(event),"registration"===stage||"updateUserDetails"===stage?function onRegistrationOrUpdate(event){const passwordInput=event.currentTarget.elements.namedItem("password"),firstNameInput=event.currentTarget.elements.namedItem("firstName"),lastNameInput=event.currentTarget.elements.namedItem("lastName"),termsCheckbox=event.currentTarget.elements.namedItem("terms");if(passwordInput&&firstNameInput&&lastNameInput&&email){const password=passwordInput.value.trim(),firstName=firstNameInput.value.trim(),lastName=lastNameInput.value.trim(),terms=!("registration"!==stage||!termsCheckbox)&&termsCheckbox.checked;var _emailData$data3,_emailData$data3$user;"registration"===stage?(biAction(PpLoginPage_page_objectSpread({action_id:61,feature_type:"Login",newsletter_email:email,stage:"login "},getBiData())),registrationData.mutate({input:{email,password,siteId:s_consts_src.OE,anonymousId,trmsChk:null!==(_emailData$data3=emailData.data)&&void 0!==_emailData$data3&&null!==(_emailData$data3$user=_emailData$data3.user)&&void 0!==_emailData$data3$user&&_emailData$data3$user.termsCheck||!0===terms?"on":"off",firstName,lastName,isEntitlement:!1,restEntryType:"PROMOTIONS_PAGE"}})):(biAction(PpLoginPage_page_objectSpread({action_id:172,feature_type:"Login",newsletter_email:email,stage:"login "},getBiData())),updateUserData.mutate({input:{email,password,siteId:s_consts_src.OE,firstName,lastName}}))}}(event):"login"===stage&&function onLogin(event){const passwordInput=event.currentTarget.elements.namedItem("password"),termsCheckbox=event.currentTarget.elements.namedItem("terms");if(passwordInput&&email){var _emailData$data2,_emailData$data2$user;const password=passwordInput.value,terms=(null==termsCheckbox?void 0:termsCheckbox.checked)||!1;biAction(PpLoginPage_page_objectSpread({action_id:60,feature_type:"Login",newsletter_email:email,stage:"login"},getBiData())),loginData.mutate({input:{email,password,siteId:s_consts_src.OE,anonymousId,trmsChk:null!==(_emailData$data2=emailData.data)&&void 0!==_emailData$data2&&null!==(_emailData$data2$user=_emailData$data2.user)&&void 0!==_emailData$data2$user&&_emailData$data2$user.termsCheck||!0===terms?"on":"off"}})}}(event)}},"emailEntry"===stage?__jsx(EmailField.Z,null):null,"login"===stage?__jsx(components_LoginForm,{email,termsCheck:(null===(_emailData$data4=emailData.data)||void 0===_emailData$data4||null===(_emailData$data4$user=_emailData$data4.user)||void 0===_emailData$data4$user?void 0:_emailData$data4$user.termsCheck)||!1,clearEmail,setShowForgotPasswordModal,getBiData}):null,"registration"===stage||"updateUserDetails"===stage?__jsx(components_RegistrationForm,{email,termsCheck:!0===(null===(_emailData$data5=emailData.data)||void 0===_emailData$data5||null===(_emailData$data5$user=_emailData$data5.user)||void 0===_emailData$data5$user?void 0:_emailData$data5$user.termsCheck)||"updateUserDetails"===stage,clearEmail,getBiData}):null,errors?__jsx(s_pp_errors_src,null,errors):null,__jsx(s_button_src.ZP,(0,esm_extends.Z)({type:"submit"},buttonStateProps,{styleExtend:[c.button,c.fullWidthColumn]}),"המשך"))),__jsx(s_pp_image_src.Z,{styleExtend:[c.image]}))}try{PpLoginPagepage.displayName="PpLoginPagepage",PpLoginPagepage.__docgenInfo={description:"",displayName:"PpLoginPagepage",props:{PurchasePage:{defaultValue:null,description:"",name:"PurchasePage",required:!1,type:{name:"({ pageData: { contentId: string; couponId?: string | null | undefined; couponErrorMessage?: string | null | undefined; personalCouponId?: string | null | undefined; thankYouPageText?: string | ... 1 more ... | undefined; ... 8 more ...; image?: ({ ...; } & ... 1 more ... & { ...; }) | ... 1 more ... | undefined; } ..."}},__typename:{defaultValue:null,description:"",name:"__typename",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"Query"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../../pp-pages/s-pp-login-page/src/PpLoginPage.page.tsx#PpLoginPagepage"]={docgenInfo:PpLoginPagepage.__docgenInfo,name:"PpLoginPagepage",path:"../../pp-pages/s-pp-login-page/src/PpLoginPage.page.tsx#PpLoginPagepage"})}catch(__react_docgen_typescript_loader_error){}var jsx_runtime=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/jsx-runtime.js"),esm=__webpack_require__("../../../node_modules/.pnpm/@mdx-js+react@1.6.22_react@18.2.0/node_modules/@mdx-js/react/dist/esm.js"),dist_esm=__webpack_require__("../../../node_modules/.pnpm/@storybook+addon-docs@6.5.16_pu76jrox5ef7vkjrotgp34yn6i/node_modules/@storybook/addon-docs/dist/esm/index.js");function _createMdxContent(props){const _components=Object.assign({h1:"h1",h2:"h2",p:"p",strong:"strong",code:"code",pre:"pre",h3:"h3"},(0,esm.ah)(),props.components);return(0,jsx_runtime.jsxs)(jsx_runtime.Fragment,{children:[(0,jsx_runtime.jsx)(_components.h1,{children:"PpLoginPage"}),"\n",(0,jsx_runtime.jsx)("br",{}),"\n","\n","\n","\n",(0,jsx_runtime.jsx)(_components.h2,{children:"Installation"}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:(0,jsx_runtime.jsxs)(_components.strong,{children:["Make sure the package you use ",(0,jsx_runtime.jsx)(_components.code,{children:"PpLoginPage"})," in has ",(0,jsx_runtime.jsx)(_components.code,{children:"@haaretz/s-pp-login-page"}),"\nlisted in its ",(0,jsx_runtime.jsx)(_components.code,{children:"package.json"}),"'s ",(0,jsx_runtime.jsx)(_components.code,{children:"dependencies"})," field:"]})}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-js",children:'// package.json\n{\n  // ...\n  "dependencies": {\n    "@haaretz/s-pp-login-page": "workspace:*"\n    // ...\n  }\n}\n'})}),"\n",(0,jsx_runtime.jsxs)(_components.p,{children:["Because internal monorepo packages are wired up using TypeScript's path aliases\nfeature in dev mode, importing ",(0,jsx_runtime.jsx)(_components.code,{children:"PpLoginPage"})," without listing it as a dependency\nwill work in dev mode, but will fail in production. There should be a\n",(0,jsx_runtime.jsx)(_components.code,{children:"import/no-unresolved"})," eslint error when trying to import it when it is not\nlisted as a dependency."]}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:"You can then import it like this:"}),"\n",(0,jsx_runtime.jsx)(_components.pre,{children:(0,jsx_runtime.jsx)(_components.code,{className:"language-js",children:"import PpLoginPage from '@haaretz/s-pp-login-page';\n"})}),"\n",(0,jsx_runtime.jsx)(_components.h2,{children:"Overview"}),"\n",(0,jsx_runtime.jsx)(_components.p,{children:" Purchase app offers page"}),"\n",(0,jsx_runtime.jsx)(dist_esm.Xz,{withToolbar:!0,children:(0,jsx_runtime.jsx)(dist_esm.oG,{id:"purchase/pages-PpLoginPage--overview"})}),"\n",(0,jsx_runtime.jsx)(_components.h3,{children:"Props"}),"\n",(0,jsx_runtime.jsx)(dist_esm.$4,{story:"^"}),"\n",(0,jsx_runtime.jsx)(_components.h2,{children:"Variants"}),"\n"]})}const PpLoginPage_doc=function MDXContent(props={}){const{wrapper:MDXLayout}=Object.assign({},(0,esm.ah)(),props.components);return MDXLayout?(0,jsx_runtime.jsx)(MDXLayout,Object.assign({},props,{children:(0,jsx_runtime.jsx)(_createMdxContent,props)})):_createMdxContent(props)},loginPageMockData={PurchasePage:{pageData:{allSteps:[{__typename:"StepData",content:[],instructions:null,messages:[],name:"offers",title:"בחרו את המינוי המתאים לכם"},{__typename:"StepData",content:[],instructions:null,messages:[],name:"login",title:null},{__typename:"StepData",content:[],instructions:"כעת בחרו את אמצעי התשלום",messages:[],name:"payment",title:"כמעט סיימנו."},{__typename:"StepData",content:[],instructions:null,messages:[],name:"thankYou",title:null}],contentId:"00000182-34fe-d570-a1a3-f7ff05430001",annual:[{__typename:"PurchaseOffer",benefits:[{__typename:"HtmlNode",as:"p",content:"גישה מלאה <b>לדודשך</b>",id:null},{__typename:"HtmlNode",as:"p",content:"גישה מלאה <b>לדודהשך</b>",id:null},{__typename:"HtmlNode",as:"p",content:"",id:null}],benefitsHeading:"הצעה מעולה בשבילכם",contentId:"00000184-3d51-d533-a3ce-bd5b1f680000",description:'4.9 לחודש+590 ש"ח ל 11 חודשים ומלא',exclusive:null,legalText:[{__typename:"HtmlNode",as:"p",content:'<b>במסלול תשלום שנתי</b>, העסקה היא מתמשכת: עם הרכישה נגבה תשלום של 290 ש"ח בעבור השנה הראשונה (מחיר הטבה לשנה הראשונה). החל מהשנה השנייה ואילך ייגבה בתחילת כל שנה תשלום בסך 490 ש"ח (תעריף נוכחי), החסכון בשנה הראשונה הוא בהשוואה למחיר במסלול תשלום חודשי המפורסם באתר. אם יחול שינוי בתעריף, תישלח על כך הודעה מראש בדואר האלקטרוני.',id:null},{__typename:"HtmlNode",as:"p",content:"",id:null},{__typename:"HtmlNode",as:"p",content:'<b>במסלול תשלום חודשי</b>, העסקה היא מתמשכת, והתשלום בסך 49 ש"ח (מחיר מחירון נוכחי) יגבה בכל חודש. אם יחול שינוי בתעריף, תישלח על כך הודעה מראש בדואר האלקטרוני.',id:null},{__typename:"HtmlNode",as:"p",content:"",id:null},{__typename:"HtmlNode",as:"p",content:"",id:null},{__typename:"HtmlNode",as:"p",content:"<b>ניתן לבטל את המינוי בכל עת באמצעות פנייה <u>לשירות הלקוחות שלנו</u></b>, <b>ולקבל החזר כספי באופן יחסי לתקופת השימוש במינוי.</b> המינוי הינו אישי ואינו ניתן להעברה או לשימוש על ידי גורם אחר.",id:null}],line1Text:[{__typename:"HtmlNode",as:"p",content:"4.90 לחודש הראשון<br>",id:null}],line2Text:[],offerHighlight:"הכי משתלם",paymentType:"J4",periodCalc:12,prices:[4.9,590],product:"BOTH",productName:"מינוי להארץ + TheMarker",saleCode:3008,thankYouMailTemplate:"6106",promotionNumber:6792,productNumber:274},{__typename:"PurchaseOffer",benefits:[{__typename:"HtmlNode",as:"p",content:"גישה מלאה לכל תכני <b>הארץ</b> ו-<b>TheMarker</b> באתר ובאפליקציות ",id:null},{__typename:"HtmlNode",as:"p",content:"10 כתבות מתנה לשליחה ושיתוף חברים",id:null},{__typename:"HtmlNode",as:"p",content:"טוקבקים באישור מהיר באתר הארץ ו-TheMarker",id:null},{__typename:"HtmlNode",as:"p",content:"״היומית״: דיוור ערב עם המלצות למנויים בלבד<br>",id:null}],benefitsHeading:null,contentId:"00000184-38a9-d103-ada5-3db9e0860000",description:"מנוי שנתי מלא",exclusive:null,legalText:[{__typename:"HtmlNode",as:"p",content:'<b>במסלול תשלום שנתי</b>, העסקה היא מתמשכת, עם הרכישה נגבה תשלום של 4.90 ש"ח בעבור החודש הראשון, ובחודש הבא 590 ש"ח (תעריף נוכחי) עבור יתרת השנה. החל מהשנה השנייה ואילך ייגבה בתחילת כל שנה תשלום בסך 690 ש"ח (תעריף נוכחי), החיסכון בשנה הראשונה הוא בהשוואה למחיר במסלול תשלום חודשי המפורסם באתר. אם יחול שינוי בתעריף, תישלח על כך הודעה מראש בדואר האלקטרוני.',id:null},{__typename:"HtmlNode",as:"p",content:"",id:null},{__typename:"HtmlNode",as:"p",content:'<b>במסלול תשלום חודשי</b>, העסקה היא מתמשכת, והתשלום בסך 65 ש"ח (מחיר מחירון נוכחי) יגבה בכל חודש. אם יחול שינוי בתעריף, תישלח על כך הודעה מראש בדואר האלקטרוני.',id:null},{__typename:"HtmlNode",as:"p",content:"",id:null},{__typename:"HtmlNode",as:"p",content:'<b>ניתן לבטל את המינוי בכל עת באמצעות פנייה </b><a class="#a#" href="/misc/contact-us">לשירות הלקוחות שלנו</a>, <b>ולקבל החזר כספי באופן יחסי לתקופת השימוש במינוי.</b> המינוי הינו אישי ואינו ניתן להעברה או לשימוש על ידי גורם אחר.',id:null}],line1Text:[{__typename:"HtmlNode",as:"p",content:"<b>רכשו ב-3.90</b>₪ בחודש הראשון",id:null}],line2Text:[],offerHighlight:null,paymentType:"J4",periodCalc:12,prices:[4.9,460],product:"HTZ",productName:"מינוי להארץ",saleCode:3031,thankYouMailTemplate:"6107",promotionNumber:6107,productNumber:243}],couponErrorMessage:null,marketingBullets:[],monthly:[{__typename:"PurchaseOffer",benefits:[{__typename:"HtmlNode",as:"p",content:"* <b>גישה מלאה</b> לכל תכני הארץ ו-TheMarker באתר ובאפליקציות ",id:null},{__typename:"HtmlNode",as:"p",content:"* 10 כתבות <b>מתנה </b>לשליחה ושיתוף חברים ",id:null},{__typename:"HtmlNode",as:"p",content:"* <b>טוקבקים </b>באישור מהיר באתר הארץ ו-TheMarker ",id:null},{__typename:"HtmlNode",as:"p",content:"* ״היומית״: <b>דיוור ערב</b> עם המלצות למנויים בלבד<br>",id:null}],benefitsHeading:"הכי משתלם",contentId:"00000184-38a1-d103-ada5-3db1b92f0000",description:"מחיר מלא - חודשי",exclusive:"הכי משתלם",legalText:[{__typename:"HtmlNode",as:"p",content:'<b>במסלול תשלום שנתי</b>, העסקה היא מתמשכת: עם הרכישה נגבה תשלום של 290 ש"ח בעבור השנה הראשונה (מחיר הטבה לשנה הראשונה). החל מהשנה השנייה ואילך ייגבה בתחילת כל שנה תשלום בסך 490 ש"ח (תעריף נוכחי), החסכון בשנה הראשונה הוא בהשוואה למחיר במסלול תשלום חודשי המפורסם באתר. אם יחול שינוי בתעריף, תישלח על כך הודעה מראש בדואר האלקטרוני.',id:null},{__typename:"HtmlNode",as:"p",content:"",id:null},{__typename:"HtmlNode",as:"p",content:'<b>במסלול תשלום חודשי</b>, העסקה היא מתמשכת, והתשלום בסך 49 ש"ח (מחיר מחירון נוכחי) יגבה בכל חודש. אם יחול שינוי בתעריף, תישלח על כך הודעה מראש בדואר האלקטרוני.',id:null},{__typename:"HtmlNode",as:"p",content:"",id:null},{__typename:"HtmlNode",as:"p",content:"",id:null},{__typename:"HtmlNode",as:"p",content:"<b>ניתן לבטל את המינוי בכל עת באמצעות פנייה <u>לשירות הלקוחות שלנו</u></b>, <b>ולקבל החזר כספי באופן יחסי לתקופת השימוש במינוי.</b> המינוי הינו אישי ואינו ניתן להעברה או לשימוש על ידי גורם אחר.",id:null}],line1Text:[{__typename:"HtmlNode",as:"p",content:"<b>רכשו ב-4.90 ש״ח בחודש הראשון</b>",id:null}],line2Text:[{__typename:"HtmlNode",as:"p",content:'ואז 49 ש"ח לחודש',id:null}],offerHighlight:null,paymentType:"J4",periodCalc:1,prices:[65,65],product:"BOTH",productName:"מינוי להארץ + TheMarker",saleCode:3030,thankYouMailTemplate:"6106",promotionNumber:6793,productNumber:274},{__typename:"PurchaseOffer",benefits:[{__typename:"HtmlNode",as:"p",content:"כל תכני הארץ במחשב ובאפליקציה",id:null},{__typename:"HtmlNode",as:"p",content:"פחות פרסומות באתר הארץ",id:null},{__typename:"HtmlNode",as:"p",content:'חדש! "היומית": דיוור ערב עם המלצות למנויים בלבד',id:null},{__typename:"HtmlNode",as:"p",content:"חדש! 10 כתבות מתנה בחודש לשליחה ושיתוף חברים",id:null},{__typename:"HtmlNode",as:"p",content:"ניתן לבטל בכל עת<br>",id:null}],benefitsHeading:"יתרונות המינוי",contentId:"00000184-3d58-d91a-a5d7-fd783c520000",description:"מחיר מלא - חודשי",exclusive:null,legalText:[{__typename:"HtmlNode",as:"p",content:'במסלול תשלום חודשי, העסקה היא מתמשכת, והתשלום בסך 49 ש"ח (מחיר מחירון נוכחי) יגבה בכל חודש. אם יחול שינוי בתעריף, תישלח על כך הודעה מראש בדואר האלקטרוני.',id:null},{__typename:"HtmlNode",as:"p",content:"ניתן לבטל את המינוי בכל עת באמצעות פנייה <u>לשירות הלקוחות שלנו</u>. המינוי הינו אישי ואינו ניתן להעברה או לשימוש על ידי גורם אחר.",id:null},{__typename:"HtmlNode",as:"p",content:"",id:null}],line1Text:[{__typename:"HtmlNode",as:"p",content:'49 ש"ח לחודש',id:null}],line2Text:[],offerHighlight:null,paymentType:"J4",periodCalc:1,prices:[49,49],product:"HTZ",productName:"מינוי להארץ",saleCode:3028,thankYouMailTemplate:"6107",promotionNumber:6107,productNumber:243}],steps:[{__typename:"StepData",content:[],instructions:null,messages:[],name:"offers",title:"בחרו את המינוי המתאים לכם"},{__typename:"StepData",content:[],instructions:null,messages:[],name:"login",title:null},{__typename:"StepData",content:[],instructions:"כעת בחרו את אמצעי התשלום",messages:[],name:"payment",title:"כמעט סיימנו."},{__typename:"StepData",content:[],instructions:null,messages:[],name:"thankYou",title:null}],specialSaleData:{__typename:"SpecialSaleData",exclusive:"תמיד מעניין בהארץ",image:null,title:"מינוי שנתי בהנחה לזמן מוגבל"},thankYouPageText:null}}};var PpLoginPage_stories_jsx=react.createElement;function PpLoginPage_stories_ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}const{decorators}=__webpack_require__("../../config/l-storybook-config/preview.js"),PpLoginPage_stories={component:LoginPage,title:"Purchase/Pages/PpLoginPage",args:{inlineStyle:{},styleExtend:[]},argTypes:{styleExtend:{control:!1}},parameters:{docs:{page:PpLoginPage_doc}},decorators:[src.Z,...decorators]},Overview=()=>PpLoginPage_stories_jsx(LoginPage,loginPageMockData);Overview.parameters=function PpLoginPage_stories_objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?PpLoginPage_stories_ownKeys(Object(source),!0).forEach((function(key){(0,defineProperty.Z)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):PpLoginPage_stories_ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}({storySource:{source:"() => (\n  <PpLoginPage {...loginPageMockData} />\n)"}},Overview.parameters);const __namedExportsOrder=["Overview"]},"../../ds-molecules/s-form-fields/src/EmailField/EmailField.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>EmailField});var esm_extends=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.1/node_modules/@babel/runtime/helpers/esm/extends.js"),objectWithoutProperties=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.1/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),react=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),src=__webpack_require__("../../ds-atoms/s-text-field/src/index.ts"),emailValidator=__webpack_require__("../../utils/s-validators/src/emailValidator/index.ts");const _excluded=["extrenalState","styleExtend","inlineStyle"];var __jsx=react.createElement;const c={field:{height:"iIftcP",width:"cRUUAa"},fullWidthColumn:{gridColumnStart:"DIEXk"}};function EmailField(_ref){var _textFieldRef$current;let{extrenalState,styleExtend=[],inlineStyle}=_ref,props=(0,objectWithoutProperties.Z)(_ref,_excluded);const[internalState,internalSetState]=react.useState("default"),state=null!=extrenalState&&extrenalState.stateProp?extrenalState.stateProp:internalState,setState=null!=extrenalState&&extrenalState.setStateProp?extrenalState.setStateProp:internalSetState,textFieldRef=react.useRef(null),value=(null===(_textFieldRef$current=textFieldRef.current)||void 0===_textFieldRef$current?void 0:_textFieldRef$current.value)||"",description=(null==extrenalState?void 0:extrenalState.descriptionState)||(0,emailValidator.Z)(value).text;return __jsx(src.ZP,(0,esm_extends.Z)({},props,{autoFocus:!0,name:"email",required:!0,maxLength:64,description,isInvalid:"default"!==state,label:"אימייל",placeholder:"you@example.com",type:"email",pattern:"\\S+@\\S+\\.\\S+",onInput:()=>{"default"!==state&&(setState("default"),(null==extrenalState?void 0:extrenalState.setDescriptionProp)&&extrenalState.setDescriptionProp(""))},styleExtend:[c.field,c.fullWidthColumn,...styleExtend],inlineStyle,onInvalid:e=>{e.preventDefault(),setState(e.currentTarget.value?"invalid":"empty")},ref:textFieldRef}))}try{EmailField.displayName="EmailField",EmailField.__docgenInfo={description:"",displayName:"EmailField",props:{description:{defaultValue:null,description:"",name:"description",required:!1,type:{name:"string | undefined"}},inlineStyle:{defaultValue:null,description:"CSS declarations to be set as inline `style` on the\nhtml element.\n\nBy setting values of CSS Custom Properties based on\nprops or state in the consuming component (where\nthe value of `inlineStyle` is passed), `inlineStyle`\ncan be used as an API contract for setting dynamic\nvalues to styles created with `style9.create()`:\n@example ```ts\nimport s9 from 'style9';\n\nconst { styleExtend, } = s9.create({\n  styleExtend: {\n    color: 'var(--color-based-on-prop)',\n  },\n});\n\nfunction MyTextField(props) {\n  const inlineStyle = {\n    '--color-based-on-prop': props.color,\n  },\n\n  return (\n   <TextField\n     styleExtend={[ styleExtend, ]}\n     inlineStyle={inlineStyle}\n   />\n  );\n}\n```",name:"inlineStyle",required:!1,type:{name:"InlineStyles | undefined"}},styleExtend:{defaultValue:{value:"[]"},description:"An array of `Style`s created by `style9.create()`.\nWARNING: **_do not_** pass simple CSS-in-JS object.\nThe items in the array must be created with Style9's\n`create` function.\nThe array can also hold falsy values to assist with\nconditional inclusion of `Style`s:\n@example ```ts\nconst { foo, bar, } = s9.create({ foo: { ... }, bar: { ... }, });\n<TextField styleExtend={[ someCondition && foo, bar, ]} />\n```",name:"styleExtend",required:!1,type:{name:"StyleExtend | undefined"}},variant:{defaultValue:null,description:"Sets the basic visual appearance of the input.\n@defaultValue 'default'",name:"variant",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"default"'},{value:'"inverse"'}]}},state:{defaultValue:null,description:"The input's functional state\n@defaultValue 'default'",name:"state",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"disabled"'},{value:'"default"'}]}},isInvalid:{defaultValue:null,description:"Indicate the input is in an invalid state",name:"isInvalid",required:!1,type:{name:"boolean | undefined"}},opaque:{defaultValue:null,description:"Give input a solid opaque background\n@defaultValue false",name:"opaque",required:!1,type:{name:"boolean | undefined"}},label:{defaultValue:null,description:"The input's label",name:"label",required:!1,type:{name:"string | undefined"}},type:{defaultValue:null,description:"The input's type attribue\n@defaultValue 'text'",name:"type",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"number"'},{value:'"text"'},{value:'"hidden"'},{value:'"search"'},{value:'"tel"'},{value:'"email"'},{value:'"password"'}]}},required:{defaultValue:null,description:"Indicates if the input is required\n@defaultValue false",name:"required",required:!1,type:{name:"boolean | undefined"}},sharp:{defaultValue:null,description:"Sets sharp corners (without border-radius) on two or more corners",name:"sharp",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"end"'},{value:'"start"'},{value:'"all"'},{value:'"top"'},{value:'"bottom"'}]}},startIcon:{defaultValue:null,description:"An icon component to place at the beginning of the input.",name:"startIcon",required:!1,type:{name:"ReactNode"}},endIcon:{defaultValue:null,description:"An icon component to place at the end of the input.",name:"endIcon",required:!1,type:{name:"ReactNode"}},hideBorder:{defaultValue:null,description:"An input edge (or edges) on which the border is invisible\n(e.g. for grouping with a button)",name:"hideBorder",required:!1,type:{name:"enum",value:[{value:"undefined"},{value:'"end"'},{value:'"start"'},{value:'"inline"'},{value:'"all"'},{value:'"top"'},{value:'"bottom"'},{value:'"block"'}]}},extrenalState:{defaultValue:null,description:"",name:"extrenalState",required:!1,type:{name:"SetState | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../../ds-molecules/s-form-fields/src/EmailField/EmailField.tsx#EmailField"]={docgenInfo:EmailField.__docgenInfo,name:"EmailField",path:"../../ds-molecules/s-form-fields/src/EmailField/EmailField.tsx#EmailField"})}catch(__react_docgen_typescript_loader_error){}},"../../ds-molecules/s-form-fields/src/EmailField/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("../../ds-molecules/s-form-fields/src/EmailField/EmailField.tsx").Z},"../../graphql/s-fragments/src/__generated__/UserCredentialsType.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{F:()=>UserCredentialsTypeFragmentGql});const UserCredentialsTypeFragmentGql="\n    fragment UserCredentialsTypeFragment on UserCredentialsType {\n  __typename\n  success\n  code\n  messages\n  user {\n    __typename\n    abuse {\n      __typename\n      redirect\n    }\n  }\n  status\n}\n    "},"../../pp-atoms/s-pp-errors/src/PpErrors.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>PpErrors});var react=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),style9=__webpack_require__("../../../node_modules/.pnpm/style9@0.17.0_rollup@2.79.1/node_modules/style9/index.mjs"),src=__webpack_require__("../../ds-atoms/s-rich-text/src/index.ts"),__jsx=react.createElement;const c_errors={textAlign:"kooHYa",color:"flyuuT",gridColumnStart:"DIEXk",marginTop:"cUXNmd",marginBottom:"biWxPv"};function PpError({children:error}){return __jsx(src.Z,{as:"p",content:error})}function PpErrors({children}){return __jsx("div",{className:(0,style9.Z)(c_errors),"aria-live":"assertive","aria-relevant":"additions"},Array.isArray(children)?children.map((error=>__jsx(PpError,{key:error},error))):children?__jsx(PpError,null,children):null)}try{PpErrors.displayName="PpErrors",PpErrors.__docgenInfo={description:"",displayName:"PpErrors",props:{children:{defaultValue:null,description:"The Children to be rendered inside `<PpErrors>`",name:"children",required:!1,type:{name:"((string | string[]) & (string | number | boolean | ReactElement<any, string | JSXElementConstructor<any>> | ReactFragment | ReactPortal | null)) | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../../pp-atoms/s-pp-errors/src/PpErrors.tsx#PpErrors"]={docgenInfo:PpErrors.__docgenInfo,name:"PpErrors",path:"../../pp-atoms/s-pp-errors/src/PpErrors.tsx#PpErrors"})}catch(__react_docgen_typescript_loader_error){}},"../../pp-atoms/s-pp-image/src/PpImage.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>PpImage});var react=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),style9=__webpack_require__("../../../node_modules/.pnpm/style9@0.17.0_rollup@2.79.1/node_modules/style9/index.mjs"),__jsx=react.createElement;const c_base={height:"jXmXEB",width:"cRBPJl",pointerEvents:"eDssNQ"};function PpImage({inlineStyle,styleExtend=[]}){return __jsx("svg",{className:(0,style9.Z)(c_base,...styleExtend),style:inlineStyle,focusable:!1,tabIndex:-1},__jsx("use",{xlinkHref:"#promotion-img"}))}try{PpImage.displayName="PpImage",PpImage.__docgenInfo={description:"",displayName:"PpImage",props:{inlineStyle:{defaultValue:null,description:"CSS declarations to be set as inline `style` on the\nhtml element.\n\nBy setting values of CSS Custom Properties based on\nprops or state in the consuming component (where\nthe value of `inlineStyle` is passed), `inlineStyle`\ncan be used as an API contract for setting dynamic\nvalues to styles created with `style9.create()`:\n@example ```ts\nimport s9 from 'style9';\nconst { styleExtend, } = s9.create({\n  styleExtend: {\n    color: 'var(--color-based-on-prop)',\n  },\n});\n\nfunction MyPpImage(props) {\n  const inlineStyle = {\n    '--color-based-on-prop': props.color,\n  },\n\n  return (\n   <PpImage\n     styleExtend={[ styleExtend, ]}\n     inlineStyle={inlineStyle}\n   />\n  );\n}\n```",name:"inlineStyle",required:!1,type:{name:"InlineStyles | undefined"}},styleExtend:{defaultValue:{value:"[]"},description:"An array of `Style`s created by `style9.create()`.\nWARNING: **_do not_** pass simple CSS-in-JS object.\nThe items in the array must be created with Style9's\n`create` function.\nThe array can also hold falsy values to assist with\nconditional inclusion of `Style`s:\n@example ```ts\nconst { foo, bar, } = s9.create({ foo: { ... }, bar: { ... }, });\n<PpImage styleExtend={[ someCondition && foo, bar, ]} />\n```",name:"styleExtend",required:!1,type:{name:"StyleExtend | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../../pp-atoms/s-pp-image/src/PpImage.tsx#PpImage"]={docgenInfo:PpImage.__docgenInfo,name:"PpImage",path:"../../pp-atoms/s-pp-image/src/PpImage.tsx#PpImage"})}catch(__react_docgen_typescript_loader_error){}},"../../pp-atoms/s-pp-image/src/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("../../pp-atoms/s-pp-image/src/PpImage.tsx").Z},"../../pp-molecules/s-pp-header/src/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("../../pp-molecules/s-pp-header/src/PpHeader.tsx").Z},"../../pp-organisms/s-pp-forgot-password/src/PpForgotPassword.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>PpForgotPassword});var esm_extends=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.1/node_modules/@babel/runtime/helpers/esm/extends.js"),react=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),style9=__webpack_require__("../../../node_modules/.pnpm/style9@0.17.0_rollup@2.79.1/node_modules/style9/index.mjs"),src=__webpack_require__("../../ds-atoms/s-button/src/index.ts"),s_pp_modal_src=__webpack_require__("../../pp-organisms/s-pp-modal/src/index.ts");var useMutation=__webpack_require__("../../../node_modules/.pnpm/@tanstack+react-query@4.24.4_biqbaboplfbrettd7655fr4n2y/node_modules/@tanstack/react-query/build/lib/useMutation.mjs"),GraphqlFetcher=__webpack_require__("../../graphql/s-graphql-fetcher/src/GraphqlFetcher.tsx");const ForgotPasswordMutationDocument="\n    mutation ForgotPasswordMutation($input: ForgotPasswordInputType!) {\n  forgotPassword(input: $input) {\n    ...ForgotPassowrdResponseTypeFragment\n  }\n}\n    \n    fragment ForgotPassowrdResponseTypeFragment on ForgotPassowrdResponseType {\n  __typename\n  success\n  code\n  message\n  status\n}\n    ",useForgotPasswordMutation=options=>(0,useMutation.D)(["ForgotPasswordMutation"],(variables=>(0,GraphqlFetcher.Z)(ForgotPasswordMutationDocument,variables)()),options);function useForgotPassword(options){return useForgotPasswordMutation(options)}useForgotPasswordMutation.getKey=()=>["ForgotPasswordMutation"],useForgotPasswordMutation.fetcher=(variables,options)=>(0,GraphqlFetcher.Z)(ForgotPasswordMutationDocument,variables,options);try{useForgotPassword.displayName="useForgotPassword",useForgotPassword.__docgenInfo={description:"",displayName:"useForgotPassword",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../../hooks/s-use-user/src/use-forgot-password/useForgotPassword.tsx#useForgotPassword"]={docgenInfo:useForgotPassword.__docgenInfo,name:"useForgotPassword",path:"../../hooks/s-use-user/src/use-forgot-password/useForgotPassword.tsx#useForgotPassword"})}catch(__react_docgen_typescript_loader_error){}const use_forgot_password=useForgotPassword;var EmailField=__webpack_require__("../../ds-molecules/s-form-fields/src/EmailField/index.ts"),s_consts_src=__webpack_require__("../../shared/s-consts/src/index.ts"),__jsx=react.createElement;const c={base:{"@media all and (min-width:37.5em)":{width:"kVOAQx"},"@media all and (max-width:37.4375em)":{paddingInlineStart:"fihjOS",paddingInlineEnd:"brNnsa"}},wrapper:{display:"gSBWlu",flexDirection:"iMkoWi",justifyContent:"IVbXa",alignItems:"foGVKH",marginInlineStart:"bMPiZO",marginInlineEnd:"gzedBA",minHeight:"gBLKjS",width:"fNvXVe","@media all and (max-width:37.4375em)":{minHeight:"ddAsqy",width:"eOgiUb"}},form:{display:"gSBWlu",flexDirection:"iMkoWi",justifyContent:"IVbXa",alignItems:"foGVKH"},emailField:{marginBottom:"cMjA_dD",width:"fNvXVe","@media all and (max-width:37.4375em)":{width:"eOgiUb"}},title:{fontSize:"dGDAum",lineHeight:"dRpeUM",marginBottom:"fmeKjt"},continueButton:{marginTop:"crUZPJ","@media all and (max-width:37.4375em)":{marginTop:"gmgMpi"}},loginButton:{marginTop:"ha_DTbp"},instructionsText:{textAlign:"kooHYa"}};function EmailStage({setStage,describedBy,email}){const[description,setDescription]=react.useState(""),[state,setState]=react.useState("default"),forgotPassword=use_forgot_password(),buttonStateProps=forgotPassword.isLoading?{state:"busy",busyNotice:"ממתין לתשובה"}:{state:"auto"};return __jsx("form",{className:(0,style9.Z)(c.form),onSubmit:e=>{e.preventDefault();const emailInput=e.currentTarget.elements.namedItem("email");emailInput&&forgotPassword.mutate({input:{site:s_consts_src.OE,userMail:emailInput.value}},{onSuccess:data=>{data.forgotPassword.success?setStage("insturctions"):(setDescription(data.forgotPassword.message||'עשינו בדיקה ומצאנו שכתובת הדוא"ל שהזנתם אינה קיימת.'),setState("invalid"))},onError:()=>{setDescription("אירעה שגיאה, אנא נסו מאוחר יותר"),setState("invalid")}})},"aria-describedby":describedBy},__jsx(EmailField.Z,{defaultValue:email,extrenalState:{descriptionState:description,stateProp:state,setStateProp:setState,setDescriptionProp:setDescription},styleExtend:[c.emailField]}),__jsx(src.ZP,(0,esm_extends.Z)({styleExtend:[c.continueButton],type:"submit"},buttonStateProps),"המשך"))}function InsturctionsStage({onClick}){return __jsx(react.Fragment,null,__jsx("p",{className:(0,style9.Z)(c.instructionsText)},"הוראות לאיפוס הסיסמא נשלחו לתיבת האימייל שלך"),__jsx(src.ZP,{onClick,styleExtend:[c.loginButton]},"סגור"))}function PpForgotPassword({email,isOpen,onToggle}){const[stage,setStage]=react.useState("email"),closeBtnHandler=()=>{onToggle(!1),setStage("email")};return __jsx(s_pp_modal_src.Z,{onToggle,isOpen,labelledBy:"change_password_title",closeBtnOnClick:closeBtnHandler,styleExtend:[c.base]},__jsx("div",{className:(0,style9.Z)(c.wrapper)},__jsx("h1",{id:"change_password_title",className:(0,style9.Z)(c.title)},"החלפת סיסמה"),"email"===stage?__jsx(EmailStage,{email,setStage,describedBy:"change_password_title"}):__jsx(InsturctionsStage,{onClick:closeBtnHandler})))}try{PpForgotPassword.displayName="PpForgotPassword",PpForgotPassword.__docgenInfo={description:"",displayName:"PpForgotPassword",props:{isOpen:{defaultValue:null,description:"Controls the opening and closing of the modal",name:"isOpen",required:!1,type:{name:"boolean | undefined"}},onToggle:{defaultValue:null,description:"A callback that is fired whenever the modal is opened or closed,\nand takes an `isOpen` boolean argument indicating if the modal is open",name:"onToggle",required:!0,type:{name:"(isOpen: boolean) => void"}},email:{defaultValue:null,description:"",name:"email",required:!0,type:{name:"string"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../../pp-organisms/s-pp-forgot-password/src/PpForgotPassword.tsx#PpForgotPassword"]={docgenInfo:PpForgotPassword.__docgenInfo,name:"PpForgotPassword",path:"../../pp-organisms/s-pp-forgot-password/src/PpForgotPassword.tsx#PpForgotPassword"})}catch(__react_docgen_typescript_loader_error){}},"../../pp-pages/s-pp-login-page/src/components/LoginForm/LoginForm.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>LoginForm});var defineProperty=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.1/node_modules/@babel/runtime/helpers/esm/defineProperty.js"),esm_extends=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.1/node_modules/@babel/runtime/helpers/esm/extends.js"),objectWithoutProperties=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.20.1/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),react=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),style9=__webpack_require__("../../../node_modules/.pnpm/style9@0.17.0_rollup@2.79.1/node_modules/style9/index.mjs"),src=__webpack_require__("../../ds-atoms/s-button/src/index.ts"),s_text_field_src=__webpack_require__("../../ds-atoms/s-text-field/src/index.ts"),s_formfield_description_src=__webpack_require__("../../ds-atoms/s-formfield-description/src/index.ts"),dist=__webpack_require__("../../../node_modules/.pnpm/next-router-mock@0.9.2_next@13.2.3+react@18.2.0/node_modules/next-router-mock/dist/index.js"),s_use_bi_src=__webpack_require__("../../hooks/s-use-bi/src/index.ts"),TermsCheckBox=__webpack_require__("../../pp-pages/s-pp-login-page/src/components/TermsCheckBox/index.ts");const _excluded=["setShowForgotPasswordModal","styleExtend"],_excluded2=["clearEmail","email","termsCheck","setShowForgotPasswordModal"];var __jsx=react.createElement;function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){(0,defineProperty.Z)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}const c={descriptionWrapper:{display:"gSBWlu",flexWrap:"fyjYdE",justifyContent:"kJzccJ",width:"cRUUAa",fontSize:"gVscJz",lineHeight:"kvNqZl","@media all and (min-width:80em)":{fontSize:"fbDSck",lineHeight:"cIlhEA"}},field:{height:"iIftcP",width:"cRUUAa"},email:{"@media all and (min-width:80em)":{fontSize:"grQyFE",lineHeight:"gzgUVO"}},clearEmail:{paddingInlineStart:"dZKiZV",paddingInlineEnd:"ckIyll","@media all and (max-width:79.9375em)":{fontSize:"lfoXAV",lineHeight:"UYkYC"}},fullWidthColumn:{gridColumnStart:"DIEXk"},termsCheckBox:{marginTop:"cyerGB"},forgetPassword:{marginInlineEnd:"ihvpmL"}};function RequiredField(_ref){let{setShowForgotPasswordModal,styleExtend=[]}=_ref,props=(0,objectWithoutProperties.Z)(_ref,_excluded);const[state,setState]=react.useState("default"),descriptionId=react.useId(),inputRef=react.useRef(null);react.useEffect((()=>{inputRef.current&&inputRef.current.focus()}),[]);const isInvalid="default"!==state;return __jsx(s_text_field_src.DO,{styleExtend:[c.field,...styleExtend],isInvalid},__jsx(s_text_field_src.Nl,(0,esm_extends.Z)({},props,{describedBy:descriptionId,isInvalid,label:"סיסמה",type:"password",minLength:1,onInput:()=>{"default"!==state&&setState("default")},onInvalid:evt=>{evt.preventDefault(),setState(evt.currentTarget.value?"invalid":"empty")},ref:inputRef})),__jsx("div",{className:(0,style9.Z)(c.descriptionWrapper)},__jsx(s_formfield_description_src.Z,{id:descriptionId,isInvalid},"נא להזין את הסיסמה שאיתה נרשמתם"),__jsx(src.ZP,{priority:"tertiary",variant:"brand",size:"small",styleExtend:[c.forgetPassword],onClick:()=>{setShowForgotPasswordModal(!0)}},"שכחתי סיסמה")))}function LoginForm(_ref2){let{clearEmail,email,termsCheck,setShowForgotPasswordModal}=_ref2,props=(0,objectWithoutProperties.Z)(_ref2,_excluded2);const router=(0,dist.useRouter)(),biAction=(0,s_use_bi_src.Z)(),restorecart=router.query.restorecart;return __jsx(react.Fragment,null,__jsx("div",{className:(0,style9.Z)(c.email,c.fullWidthColumn)},email," ",restorecart?null:__jsx(src.ZP,{priority:"tertiary",styleExtend:[c.clearEmail],type:"button",variant:"brand",onClick:event=>{event.preventDefault();const biData="function"==typeof props.getBiData?props.getBiData():props.biData;clearEmail(),biData&&biAction(_objectSpread(_objectSpread({},biData),{},{action_id:20,feature:"Promotions logout",feature_type:"Marketing",newsletter_email:email}))}},"(","התחברו עם אימייל אחר",")")),__jsx(RequiredField,{autoFocus:!0,required:!0,type:"password",name:"password",styleExtend:[c.fullWidthColumn],setShowForgotPasswordModal}),termsCheck?null:__jsx(TermsCheckBox.Z,{styleExtend:[c.fullWidthColumn,c.termsCheckBox]}))}try{LoginForm.displayName="LoginForm",LoginForm.__docgenInfo={description:"",displayName:"LoginForm",props:{email:{defaultValue:null,description:"",name:"email",required:!0,type:{name:"string"}},termsCheck:{defaultValue:null,description:"",name:"termsCheck",required:!0,type:{name:"boolean"}},clearEmail:{defaultValue:null,description:"",name:"clearEmail",required:!0,type:{name:"() => void"}},setShowForgotPasswordModal:{defaultValue:null,description:"",name:"setShowForgotPasswordModal",required:!0,type:{name:"Dispatch<SetStateAction<boolean>>"}},biData:{defaultValue:null,description:"",name:"biData",required:!1,type:{name:"BiDataOverrides | undefined"}},getBiData:{defaultValue:null,description:"",name:"getBiData",required:!1,type:{name:"(() => BiDataOverrides) | undefined"}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["../../pp-pages/s-pp-login-page/src/components/LoginForm/LoginForm.tsx#LoginForm"]={docgenInfo:LoginForm.__docgenInfo,name:"LoginForm",path:"../../pp-pages/s-pp-login-page/src/components/LoginForm/LoginForm.tsx#LoginForm"})}catch(__react_docgen_typescript_loader_error){}},"../../utils/s-validators/src/emailValidator/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{Z:()=>src_emailValidator});const src_emailValidator=function emailValidator(email){return email?/\S+@\S+\.\S+/.test(email)?email.length>64?{valid:!1,text:"תווים 64 יש להזין אימייל מעלה"}:{valid:!0,text:"אנא הזינו אימייל"}:{valid:!1,text:"יש להזין אימייל תקין"}:{valid:!1,text:"אנא הזינו אימייל"}}},"../../../node_modules/.pnpm/@tanstack+react-query@4.24.4_biqbaboplfbrettd7655fr4n2y/node_modules/@tanstack/react-query/build/lib/useMutation.mjs":(__unused_webpack___webpack_module__,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{D:()=>useMutation});var react=__webpack_require__("../../../node_modules/.pnpm/react@18.2.0/node_modules/react/index.js"),useSyncExternalStore=__webpack_require__("../../../node_modules/.pnpm/@tanstack+react-query@4.24.4_biqbaboplfbrettd7655fr4n2y/node_modules/@tanstack/react-query/build/lib/useSyncExternalStore.mjs"),utils=__webpack_require__("../../../node_modules/.pnpm/@tanstack+query-core@4.24.4/node_modules/@tanstack/query-core/build/lib/utils.mjs"),mutation=__webpack_require__("../../../node_modules/.pnpm/@tanstack+query-core@4.24.4/node_modules/@tanstack/query-core/build/lib/mutation.mjs"),notifyManager=__webpack_require__("../../../node_modules/.pnpm/@tanstack+query-core@4.24.4/node_modules/@tanstack/query-core/build/lib/notifyManager.mjs"),subscribable=__webpack_require__("../../../node_modules/.pnpm/@tanstack+query-core@4.24.4/node_modules/@tanstack/query-core/build/lib/subscribable.mjs");class MutationObserver extends subscribable.l{constructor(client,options){super(),this.client=client,this.setOptions(options),this.bindMethods(),this.updateResult()}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(options){const prevOptions=this.options;this.options=this.client.defaultMutationOptions(options),(0,utils.VS)(prevOptions,this.options)||this.client.getMutationCache().notify({type:"observerOptionsUpdated",mutation:this.currentMutation,observer:this})}onUnsubscribe(){var _this$currentMutation;this.listeners.length||(null==(_this$currentMutation=this.currentMutation)||_this$currentMutation.removeObserver(this))}onMutationUpdate(action){this.updateResult();const notifyOptions={listeners:!0};"success"===action.type?notifyOptions.onSuccess=!0:"error"===action.type&&(notifyOptions.onError=!0),this.notify(notifyOptions)}getCurrentResult(){return this.currentResult}reset(){this.currentMutation=void 0,this.updateResult(),this.notify({listeners:!0})}mutate(variables,options){return this.mutateOptions=options,this.currentMutation&&this.currentMutation.removeObserver(this),this.currentMutation=this.client.getMutationCache().build(this.client,{...this.options,variables:void 0!==variables?variables:this.options.variables}),this.currentMutation.addObserver(this),this.currentMutation.execute()}updateResult(){const state=this.currentMutation?this.currentMutation.state:(0,mutation.R)(),result={...state,isLoading:"loading"===state.status,isSuccess:"success"===state.status,isError:"error"===state.status,isIdle:"idle"===state.status,mutate:this.mutate,reset:this.reset};this.currentResult=result}notify(options){notifyManager.V.batch((()=>{var _this$mutateOptions$o,_this$mutateOptions,_this$mutateOptions$o2,_this$mutateOptions2;if(this.mutateOptions&&this.hasListeners())if(options.onSuccess)null==(_this$mutateOptions$o=(_this$mutateOptions=this.mutateOptions).onSuccess)||_this$mutateOptions$o.call(_this$mutateOptions,this.currentResult.data,this.currentResult.variables,this.currentResult.context),null==(_this$mutateOptions$o2=(_this$mutateOptions2=this.mutateOptions).onSettled)||_this$mutateOptions$o2.call(_this$mutateOptions2,this.currentResult.data,null,this.currentResult.variables,this.currentResult.context);else if(options.onError){var _this$mutateOptions$o3,_this$mutateOptions3,_this$mutateOptions$o4,_this$mutateOptions4;null==(_this$mutateOptions$o3=(_this$mutateOptions3=this.mutateOptions).onError)||_this$mutateOptions$o3.call(_this$mutateOptions3,this.currentResult.error,this.currentResult.variables,this.currentResult.context),null==(_this$mutateOptions$o4=(_this$mutateOptions4=this.mutateOptions).onSettled)||_this$mutateOptions$o4.call(_this$mutateOptions4,void 0,this.currentResult.error,this.currentResult.variables,this.currentResult.context)}options.listeners&&this.listeners.forEach((listener=>{listener(this.currentResult)}))}))}}var QueryClientProvider=__webpack_require__("../../../node_modules/.pnpm/@tanstack+react-query@4.24.4_biqbaboplfbrettd7655fr4n2y/node_modules/@tanstack/react-query/build/lib/QueryClientProvider.mjs"),lib_utils=__webpack_require__("../../../node_modules/.pnpm/@tanstack+react-query@4.24.4_biqbaboplfbrettd7655fr4n2y/node_modules/@tanstack/react-query/build/lib/utils.mjs");function useMutation(arg1,arg2,arg3){const options=(0,utils.lV)(arg1,arg2,arg3),queryClient=(0,QueryClientProvider.NL)({context:options.context}),[observer]=react.useState((()=>new MutationObserver(queryClient,options)));react.useEffect((()=>{observer.setOptions(options)}),[observer,options]);const result=(0,useSyncExternalStore.$)(react.useCallback((onStoreChange=>observer.subscribe(notifyManager.V.batchCalls(onStoreChange))),[observer]),(()=>observer.getCurrentResult()),(()=>observer.getCurrentResult())),mutate=react.useCallback(((variables,mutateOptions)=>{observer.mutate(variables,mutateOptions).catch(noop)}),[observer]);if(result.error&&(0,lib_utils.L)(observer.options.useErrorBoundary,[result.error]))throw result.error;return{...result,mutate,mutateAsync:result.mutate}}function noop(){}}}]);