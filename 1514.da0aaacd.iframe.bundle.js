(self.webpackChunk_haaretz_a_tm_sg=self.webpackChunk_haaretz_a_tm_sg||[]).push([[1514],{"../../config/l-storybook-config/wwwroot/public/configShim.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>configShim});const configShim_namespaceObject=JSON.parse('{"brightspot":"https://www.haaretz.co.il","gqlServer":"https://fake-graphql-server.haaretz.co.il/graphql","gqlServerCluster":"http://fake-graphql-server.haaretz.co.il/graphql","bIServer":"https://services.haaretz.co.il/ds","env":"prod","msConfirmation":"https://services.haaretz.co.il/ms-confirmation","msPurchaseUrl":"https://ms-purchase.haaretz.co.il","cookieGenerator":"http://cookie-generator.ms-app","personalization":"https://services.haaretz.co.il/personalization","appType":"site","GA4Key":"G-V6JW03P6HP","UAKey":"UA-589309-3"}'),configShim={getSafe(property){const keys=Array.isArray(property)?property:property.split(".");let key,value=configShim_namespaceObject;for(;keys.length;){if(null===value||"object"!=typeof value){value=void 0;break}key=keys.shift(),value=value[key]}return value},get(property){const keyPath=Array.isArray(property)?property.join("."):property,value=this.getSafe(property);if(void 0===value)throw new Error(`Configuration property "${keyPath}" is not defined`);return value},has(property){return null!=property&&void 0!==this.getSafe(property)}}},"../../graphql/s-graphql-fetcher/src/GraphqlFetcher.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>fetcherFactory});var defineProperty=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.22.10/node_modules/@babel/runtime/helpers/esm/defineProperty.js"),objectWithoutProperties=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.22.10/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js"),configShim=__webpack_require__("../../config/l-storybook-config/wwwroot/public/configShim.js"),src=__webpack_require__("../../shared/s-consts/src/index.ts");const src_getOperationName=function getOperationName(doc){var _doc$definitions;const defenitions=null==doc||null===(_doc$definitions=doc.definitions)||void 0===_doc$definitions?void 0:_doc$definitions.filter((definition=>"OperationDefinition"===definition.kind&&definition.name));return(null==defenitions?void 0:defenitions.map((x=>{var _x$name;return null==x||null===(_x$name=x.name)||void 0===_x$name?void 0:_x$name.value}))[0])||null};const src_getOperationType=function getOperationType(doc){var _doc$definitions;const defenition=null==doc||null===(_doc$definitions=doc.definitions)||void 0===_doc$definitions?void 0:_doc$definitions.find((definition=>"OperationDefinition"===definition.kind));return(null==defenition?void 0:defenition.operation)||"query"};var parser=__webpack_require__("../../../node_modules/.pnpm/graphql@16.7.1/node_modules/graphql/language/parser.mjs"),console=__webpack_require__("../../../node_modules/.pnpm/console-browserify@1.2.0/node_modules/console-browserify/index.js");const src_parseQuery=function parseQuery(query){try{return(0,parser.Qc)(query)}catch(err){return console.error(err.message),null}};var breakUrl=__webpack_require__("../../utils/s-url-utils/src/breakUrl/index.ts");const src_getHtzHostname=function getHtzHostname(url){const{hostname}=(0,breakUrl.Z)(url),[,htzHostname]=/(?:.+)?((?:\.)?(?:haaretz|themarker)(?:\.co\.il|\.com))/.exec(hostname)||[];if(!htzHostname)throw new Error(`Something went wrong, htz hostname of ${hostname} not found`);return htzHostname};const src_switchToDomain=function switchToDomain(url,replaceTo){const newHostname=src_getHtzHostname(replaceTo),hostname=src_getHtzHostname(url);if("string"==typeof url){return url.replace(hostname,newHostname)}const result=url.hostname.replace(hostname,newHostname);return url.hostname=result,url};var enc_hex=__webpack_require__("../../../node_modules/.pnpm/crypto-js@4.1.1/node_modules/crypto-js/enc-hex.js"),enc_hex_default=__webpack_require__.n(enc_hex),sha256=__webpack_require__("../../../node_modules/.pnpm/crypto-js@4.1.1/node_modules/crypto-js/sha256.js"),sha256_default=__webpack_require__.n(sha256),GraphqlFetcher_console=__webpack_require__("../../../node_modules/.pnpm/console-browserify@1.2.0/node_modules/console-browserify/index.js");const _excluded=["host","connection"];function ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function _objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}const gqlServerKey="undefined"==typeof window?"gqlServerCluster":"gqlServer",gqlServerUrl=configShim.Z.get(gqlServerKey),hostname=`www.${src.Kn}`;function fetcherFactory(query,variables,headers){let options=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return async function fetcher(context){try{const document=src_parseQuery(query),operationName=document&&src_getOperationName(document)||"",operationType=document&&src_getOperationType(document)||"",url=gqlServerUrl.startsWith("https://")?src_switchToDomain(gqlServerUrl,"haaretz.co.il"):gqlServerUrl,sha256Hash=sha256_default()(query).toString(enc_hex_default()),{signal}=context||{},params={operationName,variables:JSON.stringify(variables||{}),extensions:JSON.stringify({persistedQuery:{version:1,sha256Hash}})},_contentType$accept$=_objectSpread(_objectSpread({},headers||{}),{},{"content-type":"application/json",accept:"application/json",hostname}),{host,connection}=_contentType$accept$,defaultHeaders=(0,objectWithoutProperties.Z)(_contentType$accept$,_excluded),queryParams=new URLSearchParams(params);if("query"===operationType){const persistedResult=await fetch(`${url}?${queryParams.toString()}`,_objectSpread({credentials:"include",method:"GET",headers:defaultHeaders,signal},options));if(persistedResult.status<400){var _persistendData$error;const persistendData=await persistedResult.json();if(null==persistendData||null===(_persistendData$error=persistendData.errors)||void 0===_persistendData$error||!_persistendData$error.some((error=>"PersistedQueryNotFound"===error.message)))return persistendData.data}}const result=await fetch(`${url}?operation=${operationName}`,_objectSpread({method:"POST",credentials:"include",headers:defaultHeaders,body:JSON.stringify({query,variables:JSON.parse(queryParams.get("variables")||""),operationName,extensions:JSON.parse(queryParams.get("extensions")||"")}),signal},options)),json=await result.json();if(json.errors){const{message}=json.errors[0]||{};throw new Error(message||"Error…")}return json.data}catch(error){throw GraphqlFetcher_console.error(`GraphQL fetcher error: ${error.message}`),error}}}},"../../shared/s-consts/src/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Aq:()=>currency,Bt:()=>defaultUser,K9:()=>USER_ASSISTANCE,Kn:()=>hostname,Mc:()=>PP_STORE_DATA_KEY,OE:()=>siteId,TQ:()=>defaultNetworkErrorMessage,UB:()=>PP_PREV_STEPS_KEY,pq:()=>siteAlias});var _haaretz_s_common_utils_capitalize__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("../../utils/s-common-utils/src/capitalize/index.ts");const hostname="haaretz.co.il",UserTypes_anonymous="anonymous",defaultUser={anonymousId:"",extendedType:(0,_haaretz_s_common_utils_capitalize__WEBPACK_IMPORTED_MODULE_0__.Z)(UserTypes_anonymous),type:UserTypes_anonymous,university:!1},siteId=80,defaultNetworkErrorMessage="לא הצלחנו לקבל תשובה מהשרת, אנא נסו שוב.",siteAlias="HTZ",PP_STORE_DATA_KEY="pp-store-data",currency="ILS",PP_PREV_STEPS_KEY="pp-prev-steps",USER_ASSISTANCE="USER_ASSISTANCE"},"../../utils/s-atoms/src/user/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>__WEBPACK_DEFAULT_EXPORT__});const __WEBPACK_DEFAULT_EXPORT__=__webpack_require__("../../utils/s-atoms/src/user/userAtom.ts").Z},"../../utils/s-atoms/src/user/userAtom.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>user_userAtom,L:()=>userAtom});var defineProperty=__webpack_require__("../../../node_modules/.pnpm/@babel+runtime@7.22.10/node_modules/@babel/runtime/helpers/esm/defineProperty.js"),src=__webpack_require__("../../shared/s-consts/src/index.ts"),useQuery=__webpack_require__("../../../node_modules/.pnpm/@tanstack+react-query@4.36.1_react-dom@18.2.0_react@18.2.0/node_modules/@tanstack/react-query/build/lib/useQuery.mjs"),GraphqlFetcher=(__webpack_require__("../../../node_modules/.pnpm/@tanstack+react-query@4.36.1_react-dom@18.2.0_react@18.2.0/node_modules/@tanstack/react-query/build/lib/useInfiniteQuery.mjs"),__webpack_require__("../../graphql/s-graphql-fetcher/src/GraphqlFetcher.tsx"));const UserTypePersonalQueryDocument="\n    query UserTypePersonalQuery($site: Site!) {\n  user {\n    __typename\n    type(site: $site)\n    extendedType(site: $site)\n  }\n}\n    ",useUserTypePersonalQuery=(variables,options)=>(0,useQuery.a)(["UserTypePersonalQuery",variables],(0,GraphqlFetcher.Z)(UserTypePersonalQueryDocument,variables),options);useUserTypePersonalQuery.document=UserTypePersonalQueryDocument,useUserTypePersonalQuery.getKey=variables=>["UserTypePersonalQuery",variables];useUserTypePersonalQuery.fetcher=(variables,options)=>(0,GraphqlFetcher.Z)(UserTypePersonalQueryDocument,variables,options);var cookieToMap=__webpack_require__("../../utils/s-cookie-utils/src/cookieToMap/index.ts");const src_isValidSsoMap=function isValidSsoMap(ssoMap){return!!(ssoMap&&void 0!==ssoMap&&"object"==typeof ssoMap&&"string"==typeof ssoMap.userMail&&"string"==typeof ssoMap.userMail&&/\S+@\S+\.\S+/.test(ssoMap.userMail))};function createUser_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function createUser_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?createUser_ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):createUser_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}const src_createUser=function createUser(cookieVal){let forceRefresh=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const cookieMap=(0,cookieToMap.Z)(cookieVal,forceRefresh),ssoMap=null==cookieMap?void 0:cookieMap.userDetails,anonymousId=cookieMap.anonymousId;let userOptions=src.Bt;return ssoMap&&"object"==typeof ssoMap&&src_isValidSsoMap(ssoMap)&&(userOptions=createUser_objectSpread(createUser_objectSpread({},userOptions),ssoMap)),"string"==typeof anonymousId&&(userOptions=createUser_objectSpread(createUser_objectSpread({},userOptions),{},{anonymousId})),userOptions};var _window,vanilla=__webpack_require__("../../../node_modules/.pnpm/jotai@2.4.3_@types+react@18.2.25_react@18.2.0/node_modules/jotai/esm/vanilla.mjs"),react=__webpack_require__("../../../node_modules/.pnpm/jotai@2.4.3_@types+react@18.2.25_react@18.2.0/node_modules/jotai/esm/react.mjs"),console=__webpack_require__("../../../node_modules/.pnpm/console-browserify@1.2.0/node_modules/console-browserify/index.js");function userAtom_ownKeys(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);r&&(o=o.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,o)}return t}function userAtom_objectSpread(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?userAtom_ownKeys(Object(t),!0).forEach((function(r){(0,defineProperty.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):userAtom_ownKeys(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}const initialUser=userAtom_objectSpread(userAtom_objectSpread({},src.Bt),{},{isLoggedIn:!1}),baseUserAtom=(0,vanilla.cn)(initialUser);baseUserAtom.debugPrivate=!0;const userAtom=(0,vanilla.cn)((get=>get(baseUserAtom)),(async(_get,set,action)=>{if("object"==typeof action)set(baseUserAtom,action);else if("logout"===action)set(baseUserAtom,initialUser);else if("login"===action){const clientUser=src_createUser(document.cookie,!0),isLoggedIn=!!clientUser.userMail,types=await getUserWithTypes(isLoggedIn,document.cookie);set(baseUserAtom,userAtom_objectSpread(userAtom_objectSpread(userAtom_objectSpread({},clientUser),types),{},{isLoggedIn}))}else console.error(`Invalid user action: ${action}`)}));function getUserWithTypes(isLoggedIn,cookie){return new Promise((resolve=>isLoggedIn?useUserTypePersonalQuery.fetcher({site:src.pq},{cookie})().then((data=>null!=data&&data.user?resolve(data.user):resolve(src.Bt))).catch((error=>(console.error(error.message),resolve(src.Bt)))):resolve(src.Bt)))}function useUser(){return(0,react.KO)(userAtom)}userAtom.debugLabel="user","undefined"==typeof window||null!==(_window=window)&&void 0!==_window&&null!==(_window=_window.__NEXT_DATA__)&&void 0!==_window&&null!==(_window=_window.props)&&void 0!==_window&&null!==(_window=_window.pageProps)&&void 0!==_window&&_window.user||(userAtom.onMount=setAtom=>{const clientUser=src_createUser(document.cookie,!0),isLoggedIn=!!clientUser.userMail;getUserWithTypes(isLoggedIn,document.cookie).then((types=>{setAtom(userAtom_objectSpread(userAtom_objectSpread(userAtom_objectSpread({},clientUser),types),{},{isLoggedIn}))}))}),useUser.userDispenserFactory=function userDispenserFactory(cookie,types){const newUser=src_createUser(cookie,!0);return userAtom_objectSpread(userAtom_objectSpread(userAtom_objectSpread({},newUser),types),{},{isLoggedIn:!!newUser.userMail})},useUser.getUserWithTypes=getUserWithTypes;const user_userAtom=useUser},"../../utils/s-common-utils/src/capitalize/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>src_capitalize});const src_capitalize=function capitalize(str){return str.replace(/\b[a-z]/gi,(function(char){return char.toUpperCase()}))}},"../../utils/s-common-utils/src/decodeUnicodeBase64/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>decodeUnicodeBase64});var Buffer=__webpack_require__("../../../node_modules/.pnpm/buffer@6.0.3/node_modules/buffer/index.js").lW;const decodeUnicodeBase64=function b64DecodeUnicode(str){return"undefined"==typeof document?Buffer.from(str,"base64").toString("utf-8"):decodeURIComponent(Array.prototype.map.call(atob(str),(function(c){return`%${`00${c.charCodeAt(0).toString(16)}`.slice(-2)}`})).join(""))}},"../../utils/s-cookie-utils/src/cookieToMap/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>src_cookieToMap});var decodeUnicodeBase64=__webpack_require__("../../utils/s-common-utils/src/decodeUnicodeBase64/index.ts"),stringToMap=__webpack_require__("../../utils/s-cookie-utils/src/stringToMap/stringToMap.ts"),console=__webpack_require__("../../../node_modules/.pnpm/console-browserify@1.2.0/node_modules/console-browserify/index.js");let cookieAsMap;const src_cookieToMap=function cookieToMap(cookieVal){if(!cookieAsMap||arguments.length>1&&void 0!==arguments[1]&&arguments[1]){if(cookieAsMap=(0,stringToMap.Z)(cookieVal,{separator:/;\s?/}),"string"==typeof cookieAsMap.user_details)try{cookieAsMap.userDetails=JSON.parse((0,decodeUnicodeBase64.Z)(cookieAsMap.user_details)),delete cookieAsMap.user_details}catch(error){console.error(error.message)}if("string"==typeof cookieAsMap["promotions-response-message"])try{cookieAsMap.ppResponseMessage=JSON.parse(cookieAsMap["promotions-response-message"]),delete cookieAsMap["promotions-response-message"]}catch(error){console.error(error.message)}}return cookieAsMap}},"../../utils/s-cookie-utils/src/stringToMap/stringToMap.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>stringToMap});var console=__webpack_require__("../../../node_modules/.pnpm/console-browserify@1.2.0/node_modules/console-browserify/index.js");function stringToMap(str){let{separator=/;\s*/,operator="="}=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const map=Object.create(null);if("string"!=typeof str)throw new Error(`Parameter 'str' must be string, current value is ${str}`);if(!(separator instanceof RegExp))throw new Error(`Parameter 'Separator' must be instance of RegExp, current value is ${separator}`);if("string"!=typeof operator)throw new Error(`Parameter 'operator' must be string, current value is ${operator}`);return str.split(separator).forEach((element=>{if("string"==typeof element){const splitPos=element.indexOf(operator),keyValue=[element.substring(0,splitPos),element.substring(splitPos+1)];try{keyValue[0]&&(map[keyValue[0]]=decodeURIComponent(keyValue[1]))}catch(error){console.error(error.message)}}})),map}},"../../utils/s-url-utils/src/breakUrl/index.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>src_breakUrl});const src_breakUrl=function breakUrl(url){if(!("string"==typeof url)||url.indexOf("://")>0||0===url.indexOf("//")){const{href,origin,protocol,username,password,hostname,port,pathname,search,hash,host,searchParams,toString}=new URL(url);return{href,origin,protocol,username,password,hostname,port,pathname,search,hash,host,searchParams,toString}}return function breakRelativeUrl(url){const[href="",origin="",protocol="",username="",password="",hostname="",,,port="",pathname="",search="",hash=""]=/^((?:(ws|https?)(?::\/\/))?(?:(\w.*):(.+?)@)?(([^\s?#/]+?)\.([^\s?#/]+?))?(?::(\d{2,5}))?)?(\/[^\s?#]*?)?(?:\/?(\?[^\s#]+?))?(#.+)?$/.exec(url)||[];return{href,origin,protocol,username,password,hostname,port,pathname,search,hash,host:hostname+port?`:${port}`:"",searchParams:new URLSearchParams(search),toString:url.toString}}(url)}},"?8823":()=>{}}]);